<!DOCTYPE html>
<html>
<head>
    <title>Test TradingView Dropdown</title>
    <style>
        body { 
            background: #1a1a1a; 
            color: white; 
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        .container { 
            max-width: 600px; 
            margin: 0 auto;
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
        }
        select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #333;
            color: white;
            border: 1px solid #555;
            border-radius: 4px;
            font-size: 16px;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            background: #444;
            border-radius: 4px;
        }
        #breeze-section, #tradingview-section {
            margin: 20px 0;
            padding: 15px;
            background: #3a3a3a;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Test TradingView Dropdown</h1>
        
        <div class="status">
            <strong>Current data_collection.html location:</strong><br>
            C:\Users\E1791\Kitepy\breezepython\data_collection.html
        </div>

        <label for="dataSource">Select Data Source:</label>
        <select id="dataSource" onchange="switchDataSource()">
            <option value="breeze">Breeze API</option>
            <option value="tradingview">TradingView Webhook</option>
        </select>

        <div id="breeze-section">
            <h3>Breeze API Settings</h3>
            <p>Date range inputs would appear here</p>
            <button onclick="testBreeze()">Test Breeze Collection</button>
        </div>

        <div id="tradingview-section" style="display:none;">
            <h3>TradingView Webhook Settings</h3>
            <p>Webhook URL: http://localhost:8000/webhook/tradingview</p>
            <button onclick="testWebhook()">Start Webhook Listener</button>
        </div>

        <div class="status" id="result"></div>
    </div>

    <script>
        function switchDataSource() {
            const source = document.getElementById('dataSource').value;
            const breezeSection = document.getElementById('breeze-section');
            const tradingviewSection = document.getElementById('tradingview-section');
            
            if (source === 'breeze') {
                breezeSection.style.display = 'block';
                tradingviewSection.style.display = 'none';
                document.getElementById('result').innerHTML = 'Switched to Breeze API';
            } else {
                breezeSection.style.display = 'none';
                tradingviewSection.style.display = 'block';
                document.getElementById('result').innerHTML = 'Switched to TradingView Webhook';
            }
        }

        async function testBreeze() {
            document.getElementById('result').innerHTML = 'Testing Breeze API...';
            try {
                const response = await fetch('http://localhost:8000/collect/check-status');
                const data = await response.json();
                document.getElementById('result').innerHTML = 'Breeze API Response: ' + JSON.stringify(data);
            } catch (error) {
                document.getElementById('result').innerHTML = 'Breeze Error: ' + error.message;
            }
        }

        async function testWebhook() {
            document.getElementById('result').innerHTML = 'Testing TradingView Webhook...';
            try {
                const response = await fetch('http://localhost:8000/webhook/status');
                const data = await response.json();
                document.getElementById('result').innerHTML = 'Webhook Status: ' + JSON.stringify(data);
            } catch (error) {
                document.getElementById('result').innerHTML = 'Webhook Error: ' + error.message;
            }
        }

        // Test on load
        window.onload = function() {
            console.log('Page loaded. Testing dropdown functionality...');
            document.getElementById('result').innerHTML = 'Dropdown is working! Select an option above.';
        }
    </script>
</body>
</html>